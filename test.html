<html>
<head>
<link rel="stylesheet" href="https://jonudell.info/hlib/hlib.css">
<style>
@import url(https://fonts.googleapis.com/css?family=Raleway:500,400,300,800,700);
body {
	font-family: Raleway;
  font-size: 16px;
	word-break: break-word; 
}
.urlForm input {
  width: 600px;
}
</style>
<script src="https://jonudell.info/hlib/showdown.js"></script>
<script src="https://jonudell.info/hlib/hlib.js"></script>
<script src="./index.js"></script>
<script src="./tinytest.js"></script>
</head>

<body>

<div class="formContainer">
  <div class="formField" id="urlContainer"></div>
  <div class="formField">
    sort by
    <input type="radio" checked value="location" name="sort">location</input>
    <input type="radio" value="newest" name="sort">newest</input>
  </div>
  <div>
    <button onclick="search()">search</button> 
  </div>
</div>

<div>
  <h1>Annotations</h1>
  <div id="annotations"></div>
</div>  

<div>
  <h1>Pagenotes</h1>
  <div id="pagenotes"></div>
</div>

<script>

tests({ 

'search returns expected result': function() {
  let args = {
    element: getById('urlContainer'),
    name: 'URL',
    id: 'url',
    value: getUrl(),
    onChange: 'setUrl',
    type: '',
    msg: 'URL from which to export annotations',
    };
  createNamedInputForm(args);  
  getById('urlForm').value = 'https://www.example.com';
  var searchEvent = new Event('search');
  document.dispatchEvent(searchEvent);

  waitSeconds(2)
    .then( r => {
      let exportedAnnos = getById('annotations').innerText;
      let expectedSubstr = `<section>
<blockquote><em>used</em></blockquote>
[quote_sci user="dazza"]
 <p>what is "used" anyway?</p> 
</section>`;
      let result = (exportedAnnos.indexOf(expectedSubstr) != -1);
      assert ( result == true, `expected true, got ${result}`);
     })
     .catch (e => { 
       console.log(e.message);
       failHard();
      });
  },
});
</script>

</body>
</html>